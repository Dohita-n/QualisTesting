<!-- <iframe
  #iframeElement
  [srcdoc]="tableHtml"
  frameborder="0"
  class="iframe-table"
  [style.height.px]="iframeHeight"
  (load)="onIframeLoad()"
  sandbox="allow-scripts allow-same-origin"
></iframe>  -->
<!-- Barre de recherche (RESTE FIXE) -->
<!-- <div class="mb-4 flex justify-end">
  <input
    type="text"
    placeholder="Rechercher..."
    [(ngModel)]="searchTerm"
    class="border px-3 py-1 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
  />
</div> -->

<!-- Table scrollable horizontalement -->
<div class="overflow-x-auto rounded-lg shadow">
  <table class="min-w-full divide-y divide-gray-300 dark:divide-gray-700 text-sm text-left">
    <!-- En‑tête -->
    <thead class="bg-gray-50 dark:bg-gray-800">
      <tr>
        <!-- Colonne de numérotation sticky, style personnalisé -->
        <th
          class="px-4 py-3 text-white font-bold uppercase tracking-wider whitespace-nowrap sticky left-0 z-10 border-r border-white"
          style="background: #2c3e50;"
        >
          #
        </th>
        <th
          *ngFor="let h of headers"
          class="px-4 py-3 text-gray-700 dark:text-gray-200 uppercase tracking-wider whitespace-nowrap border-r border-white"
        >
          {{ h }}
        </th>
      </tr>
    </thead>

    <!-- Corps -->
    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
      <tr
        *ngFor="let row of data; let i = index"
        class="hover:bg-indigo-50 dark:hover:bg-indigo-900/40 transition-colors group"
      >
        <!-- Cellule de numérotation sticky, style personnalisé, insensible au hover/focus -->
        <td
          class="px-4 py-2 sticky left-0 z-10 border-r border-white font-bold text-white bg-[oklch(45%_0.085_224.283)] group-hover:!bg-[oklch(45%_0.085_224.283)] group-focus-within:!bg-[oklch(45%_0.085_224.283)]"
          style="background: #2c3e50;"
        >
          {{ i + 1 }}
        </td>
        <td
          *ngFor="let h of headers"
          class="px-4 py-2 border-r border-white"
          [ngClass]="{
            'bg-yellow-200 dark:bg-yellow-400 text-black': isMatch(row[h])
          }"
        >
          <input
            class="min-w-[45px] w-full bg-transparent border border-transparent rounded-md px-2 py-1
                  focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500
                  dark:text-gray-100 dark:focus:border-indigo-400 dark:focus:ring-indigo-400"
            [value]="row[h]"
            (input)="editValue(i, h, $any($event.target).value)"
          />
        </td>
      </tr>
    </tbody>
  </table>
</div>

